(()=>{var Ke=function(n){return function(r){for(var t=n.length,e=r.length,o=new Array(t*e),a=0,p=0;p<t;p++)for(var d=n[p],_=0;_<e;_++)o[a++]=d(r[_]);return o}};var $t={compose:function(n){return function(r){return function(t){return n(r(t))}}}};var B=function(n){return n.identity},k={identity:function(n){return n},Semigroupoid0:function(){return $t}};var Tn=!0;var pn=function(n){return function(r){return function(t){return n(t)(r)}}},rn=function(n){return function(r){return n}};var Bt=function(n){return function(r){return n(r)}};var Xe=function(n){return function(r){for(var t=r.length,e=new Array(t),o=0;o<t;o++)e[o]=n(r[o]);return e}};var l=function(n){return n.map};var G=function(n){return l(n)(rn(void 0))};var en={map:Xe};var _u=B(k);var Ur={apply:Ke,Functor0:function(){return en}},V=function(n){return n.apply};var lr=function(n){var r=V(n),t=l(n.Functor0());return function(e){return function(o){return r(t(rn(_u))(e))(o)}}};var U=function(n){return n.pure};var Jn=function(n){var r=U(n);return function(t){return function(e){if(t)return e;if(!t)return r(void 0);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[t.constructor.name,e.constructor.name])}}},Cr=function(n){var r=V(n.Apply0()),t=U(n);return function(e){return function(o){return r(t(e))(o)}}};var no=function(n){return function(r){for(var t=[],e=0,o=n.length;e<o;e++)Array.prototype.push.apply(t,r(n[e]));return t}};var $r={bind:no,Apply0:function(){return Ur}},Q=function(n){return n.bind},Er=function(n){return pn(Q(n))};var sr=function(n){return function(r){for(var t=n>r?-1:1,e=new Array(t*(r-n)+1),o=n,a=0;o!==r;)e[a++]=o,o+=t;return e[a]=o,e}},bu=function(n){return function(r){if(n<1)return[];var t=new Array(n);return t.fill(r)}},yu=function(n){return function(r){for(var t=[],e=0,o=0;o<n;o++)t[e++]=r;return t}},Wn=typeof Array.prototype.fill=="function"?bu:yu,hu=function(){function n(o,a){this.head=o,this.tail=a}var r={};function t(o){return function(a){return new n(o,a)}}function e(o){for(var a=[],p=0,d=o;d!==r;)a[p++]=d.head,d=d.tail;return a}return function(o){return function(a){return e(o(t)(r)(a))}}}(),gn=function(n){return n.length};var ro=function(n){return function(r){return function(t){return function(e){return e<0||e>=t.length?r:n(t[e])}}}};var mr=function(n){if(n.length<=1e4)return Array.prototype.concat.apply([],n);for(var r=[],t=0,e=n.length;t<e;t++)for(var o=n[t],a=0,p=o.length;a<p;a++)r.push(o[a]);return r},Vn=function(n){return function(r){return r.filter(n)}};var to=function(){function n(r,t,e,o,a,p){var d,_,S,T,A,q,on;for(d=a+(p-a>>1),d-a>1&&n(r,t,o,e,a,d),p-d>1&&n(r,t,o,e,d,p),_=a,S=d,T=a;_<d&&S<p;)A=o[_],q=o[S],on=t(r(A)(q)),on>0?(e[T++]=q,++S):(e[T++]=A,++_);for(;_<d;)e[T++]=o[_++];for(;S<p;)e[T++]=o[S++]}return function(r){return function(t){return function(e){var o;return e.length<2?e:(o=e.slice(0),n(r,t,o,e.slice(0),0,e.length),o)}}}}(),jn=function(n){return function(r){return function(t){return t.slice(n,r)}}},Pn=function(n){return function(r){return function(t){for(var e=r.length<t.length?r.length:t.length,o=new Array(e),a=0;a<e;a++)o[a]=n(r[a])(t[a]);return o}}};var eo=function(n){return function(r){return n.length===0?r:r.length===0?n:n.concat(r)}};var Fn={append:eo};var W=function(n){return n.append};var qr=function(n){var r=Q(n.Bind1()),t=U(n.Applicative0());return function(e){return function(o){return r(e)(function(a){return r(o)(function(p){return t(a(p))})})}}};var Mu=String.fromCharCode(65535),xu=String.fromCharCode(0),Iu=Number.POSITIVE_INFINITY,wu=Number.NEGATIVE_INFINITY;var Lu=function(n){return function(r){return function(t){return function(e){return function(o){return e<o?n:e===o?r:t}}}}};var io=Lu;var fo=function(n){return function(r){return n===r}};var co=fo;var lo=fo;var Gn={eq:lo};var Jt={eq:co};var M=function(n){return n.eq};var b=function(){function n(){}return n.value=new n,n}(),y=function(){function n(){}return n.value=new n,n}(),N=function(){function n(){}return n.value=new n,n}();var Fr={eq:function(n){return function(r){return n instanceof b&&r instanceof b||n instanceof y&&r instanceof y||n instanceof N&&r instanceof N}}};var un=function(){return{compare:io(b.value)(N.value)(y.value),Eq0:function(){return Jt}}}();var x=function(n){return n.compare};var jt=function(n){var r=x(n);return function(t){return function(e){return function(o){return r(t(e))(t(o))}}}};var Hn=function(n){return n.top};var Br={top:2147483647,bottom:-2147483648,Ord0:function(){return un}};var Yn=function(n){return n.bottom};var mo=function(n){return function(r){for(var t=[],e=0,o=r.length;e<o;e++)t[e]=n(r[e]);return"["+t.join(",")+"]"}};var C=function(n){return n.show},kr=function(n){return{show:mo(C(n))}};var Xu=B(k),s=function(){function n(){}return n.value=new n,n}(),i=function(){function n(r){this.value0=r}return n.create=function(r){return new n(r)},n}();var nr=function(n){return function(r){return function(t){if(t instanceof s)return n;if(t instanceof i)return r(t.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[n.constructor.name,r.constructor.name,t.constructor.name])}}};var fn={map:function(n){return function(r){return r instanceof i?new i(n(r.value0)):s.value}}},Yu=l(fn);var bn=function(n){return nr(n)(Xu)},Un=function(){return function(n){if(n instanceof i)return n.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[n.constructor.name])}};var xr=function(n){var r=M(n);return{eq:function(t){return function(e){return t instanceof s&&e instanceof s?!0:t instanceof i&&e instanceof i?r(t.value0)(e.value0):!1}}}};var Vr={apply:function(n){return function(r){if(n instanceof i)return Yu(n.value0)(r);if(n instanceof s)return s.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[n.constructor.name,r.constructor.name])}},Functor0:function(){return fn}};var rr={bind:function(n){return function(r){if(n instanceof i)return r(n.value0);if(n instanceof s)return s.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[n.constructor.name,r.constructor.name])}},Apply0:function(){return Vr}};var cn=function(n){return n.mempty};var vo=function(n){return function(){return n}},_o=function(n){return function(r){return function(){return r(n())()}}};var go=function(n,r,t){var e=0,o;return function(a){if(e===2)return o;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return e=1,o=t(),e=2,o}},Do={Applicative0:function(){return tr},Bind1:function(){return zr}},zr={bind:_o,Apply0:function(){return Gt(0)}},tr={pure:vo,Apply0:function(){return Gt(0)}},bo=go("functorEffect","Effect",function(){return{map:Cr(tr)}}),Gt=go("applyEffect","Effect",function(){return{apply:qr(Do),Functor0:function(){return bo(0)}}}),E=bo(20),yo=Gt(23);var Co=function(n){return function(r){return function(){return n(r())}}},Eo=function(n){return function(){return n}},Fo=function(n){return function(r){return function(){return r(n())()}}};function dr(n){return function(){return{value:n}}}var er=function(n){return function(){return n.value}},Mo=function(n){return function(r){return function(){var t=n(r.value);return r.value=t.state,t.value}}},wr=function(n){return function(r){return function(){return r.value=n}}};var gi=function(n,r,t){var e=0,o;return function(a){if(e===2)return o;if(e===1)throw new ReferenceError(n+" was needed before it finished initializing (module "+r+", line "+a+")",r,a);return e=1,o=t(),e=2,o}},Di=Mo,xo=function(n){return Di(function(r){var t=n(r);return{state:t,value:t}})},vr={map:Co};var bi={Applicative0:function(){return Kt},Bind1:function(){return Io}},Io={bind:Fo,Apply0:function(){return wo(0)}},Kt={pure:Eo,Apply0:function(){return wo(0)}},wo=gi("applyST","Control.Monad.ST.Internal",function(){return{apply:qr(bi),Functor0:function(){return vr}}});function Gr(){return[]}var No=function(n){return function(r){return function(t){return function(e){return function(){return t>=0&&t<e.length?n(e[t]):r}}}}},Nr=function(n){return function(r){return function(t){return function(){var e=n>=0&&n<t.length;return e&&(t[n]=r),e}}}};var Yt=function(n){return function(r){return function(){return r.push.apply(r,n)}}};var _r=function(n){return function(){return n}};function yi(n){return function(){return n.slice()}}var Zt=yi,hi=function(){function n(r,t,e,o,a,p){var d,_,S,T,A,q,on;for(d=a+(p-a>>1),d-a>1&&n(r,t,o,e,a,d),p-d>1&&n(r,t,o,e,d,p),_=a,S=d,T=a;_<d&&S<p;)A=o[_],q=o[S],on=t(r(A)(q)),on>0?(e[T++]=q,++S):(e[T++]=A,++_);for(;_<d;)e[T++]=o[_++];for(;S<p;)e[T++]=o[S++]}return function(r){return function(t){return function(e){return function(){return e.length<2||n(r,t,e,e.slice(0),0,e.length),e}}}}}();var ne=function(n){return function(r){return function(){var e=Zt(r)();return n(e)(),_r(e)()}}};var Lr=function(n){return Yt([n])};var Fi=function(){return No(i.create)(s.value)}(),Lo=function(n){return function(r){return function(t){return function(){var o=Fi(n)(t)();if(o instanceof i)return Nr(n)(r(o.value0))(t)();if(o instanceof s)return!1;throw new Error("Failed pattern match at Data.Array.ST (line 193, column 3 - line 195, column 26): "+[o.constructor.name])}}}};var Po=function(n){return function(r){return n&&r}},Ao=function(n){return function(r){return n||r}},Ro=function(n){return!n};var Qr=function(n){return n.tt};var Kr=function(n){return n.not};var Xr=function(n){return n.ff};var Wr=function(n){return n.disj},$n={ff:!1,tt:!0,implies:function(n){return function(r){return Wr($n)(Kr($n)(n))(r)}},conj:Po,disj:Ao,not:Ro};var Yr=function(n){return n.conj};var ee=l(vr),Ho=Kr($n),re=G(vr),xi=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),Ii=function(n){return function(){var t=er(n.value1)();return n.value0(t)}},So=function(n){return function(){var t=er(n.value1)();return xo(function(e){return e+1|0})(n.value1)(),n.value0(t)}},Uo=function(n){return function(r){return function(t){return function(){for(var o=dr(!1)();ee(Ho)(er(o))();)(function(){var p=Ii(r)();return p instanceof i&&n(p.value0)?(Lr(p.value0)(t)(),re(So(r))()):re(wr(!0)(o))()})();return{}}}}};var $o=function(n){return ee(xi.create(n))(dr(0))},qo=function(n){return function(r){return function(){for(var e=dr(!1)();ee(Ho)(er(e))();)(function(){var a=So(n)();if(a instanceof i)return r(a.value0)();if(a instanceof s)return re(wr(!0)(e))();throw new Error("Failed pattern match at Data.Array.ST.Iterator (line 42, column 5 - line 44, column 47): "+[a.constructor.name])})();return{}}}};var Oo=function(n){return function(r){return function(t){for(var e=r,o=t.length,a=o-1;a>=0;a--)e=n(t[a])(e);return e}}},Bo=function(n){return function(r){return function(t){for(var e=r,o=t.length,a=0;a<o;a++)e=n(e)(t[a]);return e}}};var K=function(){function n(r,t){this.value0=r,this.value1=t}return n.create=function(r){return function(t){return new n(r,t)}},n}(),oe=function(n){return function(r){return n(r.value0)(r.value1)}};var Si=function(n){var r=M(n);return function(t){var e=M(t);return{eq:function(o){return function(a){return r(o.value0)(a.value0)&&e(o.value1)(a.value1)}}}}},ae=function(n){var r=x(n),t=Si(n.Eq0());return function(e){var o=x(e),a=t(e.Eq0());return{compare:function(p){return function(d){var _=r(p.value0)(d.value0);return _ instanceof b?b.value:_ instanceof y?y.value:o(p.value1)(d.value1)}},Eq0:function(){return a}}}};var et=function(n){return n};var ji=function(n){var r=Yr(n);return{append:function(t){return function(e){return r(t)(e)}}}};var ce=function(n){var r=ji(n);return{mempty:Qr(n),Semigroup0:function(){return r}}};var at=function(n){return n};var zi=function(n){var r=Wr(n);return{append:function(t){return function(e){return r(t)(e)}}}};var le=function(n){var r=zi(n);return{mempty:Xr(n),Semigroup0:function(){return r}}};var u=function(n){return n};var se=function(){return u};var Gi=se();var me=function(){return function(){return function(){return function(){return function(n){return Gi}}}}};var jo=me()()()(),qn=function(n){return n.foldr};var Ar=function(n){var r=lr(n.Apply0()),t=U(n);return function(e){var o=qn(e);return function(a){return o(function(p){return r(a(p))})(t(void 0))}}};var zo=function(n){var r=qn(n);return function(t){var e=W(t.Semigroup0()),o=cn(t);return function(a){return r(function(p){return function(d){return e(a(p))(d)}})(o)}}},ln={foldr:Oo,foldl:Bo,foldMap:function(n){return zo(ln)(n)}};var br=function(n){return n.foldMap};var de=function(n){var r=br(n);return function(t){return jo(at)(r(le(t)))}};var ve=function(n){var r=br(n);return function(t){return jo(et)(r(ce(t)))}};var Go=function(){function n(o){return[o]}function r(o){return function(a){return[o,a]}}function t(o){return function(a){return function(p){return[o,a,p]}}}function e(o){return function(a){return o.concat(a)}}return function(o){return function(a){return function(p){return function(d){return function(_){function S(T,A){switch(A-T){case 0:return p([]);case 1:return a(n)(d(_[T]));case 2:return o(a(r)(d(_[T])))(d(_[T+1]));case 3:return o(o(a(t)(d(_[T])))(d(_[T+1])))(d(_[T+2]));default:var q=T+Math.floor((A-T)/4)*2;return o(a(e)(S(T,q)))(S(q,A))}}return S(0,_.length)}}}}}}();var Sf=B(k),yr=function(n){return n.traverse};var Uf=function(n){var r=yr(n);return function(t){return r(t)(Sf)}},hr={traverse:function(n){var r=n.Apply0();return Go(V(r))(l(r.Functor0()))(U(n))},sequence:function(n){return Uf(hr)(n)},Functor0:function(){return en},Foldable1:function(){return ln}};var fa=Ar(Kt);var tc=G(vr);var ec=M(Fr);var oc=W(Fn);var dt=function(){return Pn(K.create)}(),Ee=function(n){var r=fa(n);return function(t){return function(e){return ne(function(o){return r(function(a){return Nr(a.value0)(a.value1)(o)})(t)})(e)()}}};var Fe=function(n){return to(n)(function(r){if(r instanceof y)return 1;if(r instanceof N)return 0;if(r instanceof b)return-1;throw new Error("Failed pattern match at Data.Array (line 870, column 31 - line 873, column 11): "+[r.constructor.name])})},Me=function(n){var r=jt(n);return function(t){return Fe(r(t))}};var ca=function(n){return[n]};var xe=function(n){var r=fa(n);return function(t){return function(e){return function(o){return ne(function(a){return r(function(p){return Lo(p)(e)(a)})(t)})(o)()}}}};var Y=function(){return ro(i.create)(s.value)}(),vt=function(n){return Y(n)(gn(n)-1|0)};var _t=function(n){return Y(n)(0)};var la=function(n){return function(r){return function(){var e=Gr(),o=$o(function(a){return Y(r)(a)})();return qo(o)(function(a){return tc(function(){var d=Gr();Lr(a)(d)(),Uo(n(a))(o)(d)();var _=_r(d)();return Lr(_)(e)()})})(),_r(e)()}()}},sa=function(n){var r=la(function(e){return function(o){return ec(n(e)(o))(N.value)}}),t=Fe(n);return function(e){return r(t(e))}},ma=function(n){return sa(x(n))};var Ie=function(n){return function(r){return oc([n])(r)}};var ac=pn(Q($r)),pa=function(n){return ac(function(){var r=nr([])(ca);return function(t){return r(n(t))}}())};var gt=pa(B(k));var uc=function(){function n(p){this.fn=p}var r={},t=function(p,d){this.head=p,this.tail=d};function e(p){return new t(p,r)}function o(p){return function(d){return new t(p,d)}}function a(p){for(var d=[],_=p;_!==r;)d.push(_.head),_=_.tail;return d}return function(p){return function(d){return function(_){var S=function(A,q){return p(d(o)(_(A)))(q)},T=function(A,q,on){if(q===0)return A;var mu=on[q-1];return new n(function(){var pu=T(S(mu,A),q-1,on);return pu})};return function(A){for(var q=d(e)(_(A[A.length-1])),on=T(q,A.length-1,A);on instanceof n;)on=on.fn();return d(a)(on)}}}}}();var pc=Un();var Da=function(n){return n};var dc=function(n){return function(r){return pc(n(Da(r)))}},ba=dc(_t);var vc=function(n){return function(r){return n(Da(r))}};var ya=vc(gn);function ha(n){return n.split(/[\u000a-\u000d\u0085\u2028\u2029\u0009\u0020\u00a0\u1680\u2000-\u200a\u202f\u205f\u3000]+/)}var hD=typeof Array.from=="function",TD=typeof Symbol<"u"&&Symbol!=null&&typeof Symbol.iterator<"u"&&typeof String.prototype[Symbol.iterator]=="function",CD=typeof String.prototype.fromCodePoint=="function",ED=typeof String.prototype.codePointAt=="function";var Ca=function(n){return function(r){return function(t){return(t|0)===t?n(t):r}}},On=function(n){return n};var yt=isFinite;var Ne=Math.floor;var Ea=Hn(Br),Fa=Yn(Br);var Nc=function(){return Ca(i.create)(s.value)}(),Lc=function(n){if(!yt(n))return 0;if(n>=On(Ea))return Ea;if(n<=On(Fa))return Fa;if(Tn)return bn(0)(Nc(n));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[n.constructor.name])};var Ma=function(n){return Lc(Ne(n))};var Ae=function(n){return ha(n)};var ur=function(n){return function(){console.log(n)}};var Re=Math.random;var Ra=function(n){return function(r){return function(){var e=Re(),o=(On(r)-On(n)+1)*e+On(n);return Ma(o)}}};var Tt=function(n){return function(r){return r[n]}},el=Tt("namespaceURI"),ol=Tt("prefix"),al=Tt("localName"),ul=Tt("tagName");function Ct(n){return function(r){return function(t){return function(){t.setAttribute(n,r)}}}}function Ha(n){return function(r){return function(){return r.getAttribute(n)}}}function Sa(n,r,t){return n==null?r:t(n)}var P=function(n){return Sa(n,s.value,i.create)};var Et=function(n){return function(r){return function(){return r[n]}}},sl=Et("children"),ml=Et("firstElementChild"),pl=Et("lastElementChild"),dl=Et("childElementCount");function Ft(n){return function(r){return function(){return r.querySelectorAll(n)}}}function Ua(n,r,t,e){if(typeof window<"u"){var o=window[t];if(o!=null&&e instanceof o)return r(e)}for(var a=e;a!=null;){var p=Object.getPrototypeOf(a),d=p.constructor.name;if(d===t)return r(e);if(d==="Object")return n;a=p}return n}var c=function(n){return function(r){return Ua(s.value,i.create,n,r)}};var hl=l(E);var Tr=u;var $a=function(n){var r=hl(P),t=Ha(n);return function(e){return r(t(e))}};var Mt=c("Element");var vn=function(n){return function(r){return function(){return r[n]}}};var Cl=vn("baseURI"),El=vn("ownerDocument"),Fl=vn("parentNode"),Ml=vn("parentElement");var xl=vn("childNodes"),Il=vn("firstChild"),wl=vn("lastChild"),Nl=vn("previousSibling"),Ll=vn("nextSibling"),Wl=vn("nodeValue");var Sr=vn("textContent");function Bn(n){return function(r){return function(){r.textContent=n}}}var qa=u;var Oa=c("Node");function xt(n){return function(){return[].slice.call(n)}}function Ba(n){return function(r){return function(){return r.getElementById(n)}}}var ql=l(E),ir=function(n){var r=ql(P),t=Ba(n);return function(e){return r(t(e))}};function ka(n){return n.target}var Se=function(n){return P(ka(n))};function It(n){return function(){return function(r){return n(r)()}}}function wt(n){return function(r){return function(t){return function(e){return function(){return e.addEventListener(n,r,t)}}}}}var fr=function(){return window};var Ue=u,Nt=u;function $e(n){return function(){return n.value}}function qe(n){return function(r){return function(){r.value=n}}}var za=u;var Ga=c("HTMLInputElement"),Qa=c("HTMLInputElement");function cr(n){return function(){return n.document}}var Rt=Ar(tr)(ln),hn=U(tr),Ht=l(en),Zs=xe(ln),nm=Ee(ln),ke=Q(rr),_n=l(E),St=yr(hr)(tr),rm=W(Fn),Oe=de(ln)($n),Lt=ve(ln)($n),tm=qn(ln),kn=l(fn),mn=Er(zr),em=ma(ae(un)(un)),om=Me(un),Xa=lr(yo),Be=Jn(tr),am=M(xr(Gn)),um=Er(rr);var Z=function(){function n(){}return n.value=new n,n}(),wn=function(){function n(){}return n.value=new n,n}(),Nn=function(){function n(){}return n.value=new n,n}(),Ya={show:function(n){if(n instanceof Z)return"X";if(n instanceof wn)return"O";if(n instanceof Nn)return"None";throw new Error("Failed pattern match at Main (line 42, column 1 - line 45, column 27): "+[n.constructor.name])}},Ut=C(Ya),im=C(kr(kr(Ya))),fm={eq:function(n){return function(r){return n instanceof Z&&r instanceof Z||n instanceof wn&&r instanceof wn||n instanceof Nn&&r instanceof Nn}}},Wt=M(fm),Je=function(){var n=Rt(function(t){if(t instanceof s)return hn(void 0);if(t instanceof i)return Ct("active")("true")(t.value0);throw new Error("Failed pattern match at Main (line 288, column 26 - line 290, column 51): "+[t.constructor.name])}),r=Ht(Mt);return function(t){return n(r(t))}}(),Ve=function(n){return function(r){return function(t){return Zs([r])(nm([new K(t,n)]))}}},cm=function(n){return function(r){var t=function(){return r instanceof Z?"X":r instanceof wn?"O":""}();return Bn(t)(n)}},je=function(n){var r=Rt(oe(cm)),t=dt(n);return function(e){return r(t(mr(e)))}},Za=function(n){return function(){var t=Ra(0)(gn(n)-1|0)();return Y(n)(t)}},Pt=function(n){return n instanceof Z?wn.value:n instanceof wn?Z.value:Nn.value},lm=function(n){return function(r){var t=ke(Se(r))(Ga);if(t instanceof s)return hn(void 0);if(t instanceof i)return function(){var o=$e(t.value0)(),a=function(){var p=o==="simple";return p?"complex":"simple"}();return qe(a)(t.value0)(),Bn(a)(n)()};throw new Error("Failed pattern match at Main (line 187, column 24 - line 193, column 34): "+[t.constructor.name])}},nu=function(){var n=Rt(function(t){if(t instanceof s)return hn(void 0);if(t instanceof i)return Ct("active")("false")(t.value0);throw new Error("Failed pattern match at Main (line 283, column 24 - line 285, column 52): "+[t.constructor.name])}),r=Ht(Mt);return function(t){return n(r(t))}}(),ru=function(n){return function(r){return function(){var e=It(n)();return wt("click")(e)(!1)(qa(r))()}}},tu=function(n){return n instanceof i&&n.value0 instanceof Nn},eu=function(){return Wn(3)(Wn(3)(Nn.value))}(),ou=function(n){return function(r){return ke(Y(n)(r.value0))(function(t){return Y(t)(r.value1)})}},ze=function(n){return function(){var t=Sr(n)(),e=_t(Ae(t));if(e instanceof i&&e.value0==="X")return wn.value;if(e instanceof i&&e.value0==="O")return Z.value;var o=vt(Ae(t));return o instanceof i&&o.value0==="X"?Z.value:o instanceof i&&o.value0==="O"?wn.value:Z.value}};var sm=function(n){return n==="X"?Z.value:n==="O"?wn.value:Nn.value},mm=function(){var n=_n(sm);return function(r){return n(Sr(r))}}(),Ge=function(n){return function(){var t=St(mm)(n)();return[jn(0)(3)(t),jn(3)(6)(t),jn(6)(9)(t)]}},au=function(n){var r=Vn(function(e){return e.alive})(n),t=gn(n)-gn(r)|0;return function(){var o=St(Za)(Wn(t)(r))();return rm(r)(gt(o))}},uu=Ht(function(){var n=dt(sr(0)(2)),r=Wn(3);return function(t){return n(r(t))}}())(sr(0)(2)),iu=function(n){return Oe(function(){var r=ou(n);return function(t){return tu(r(t))}}())(mr(uu))},fu=function(){var n=function(r){return Vn(function(){var t=ou(r);return function(e){return tu(t(e))}}())(mr(uu))};return function(r){return Za(n(r))}}(),At=function(n){return function(r){return Oe(Lt(function(t){return Wt(n)(t)}))(r)||Oe(Lt(function(t){return Wt(n)(t)}))(tm(Pn(Ie))([[],[],[]])(r))||Lt(function(){var t=bn(Nn.value);return function(e){return function(o){return Wt(n)(o)}(t(e))}}())(Pn(Bt)([function(t){return Y(t)(0)},function(t){return Y(t)(1)},function(t){return Y(t)(2)}])(r))||Lt(function(){var t=bn(Nn.value);return function(e){return function(o){return Wt(n)(o)}(t(e))}}())(Pn(Bt)([function(t){return Y(t)(2)},function(t){return Y(t)(1)},function(t){return Y(t)(0)}])(r))}},pm=function(n){return function(r){var t=function(e){var o=Ve(r)(e.value0)(e.value1)(n);return{initDecision:e,color:r,player:Pt(r),state:o,alive:!0,winning:At(r)(o)}};return _n(kn(t))(fu(n))}},dm=function(n){return function(r){var t=_n(gt),e=St(pm(r)),o=Wn(n);return function(a){return t(e(o(a)))}}},vm=function(n){var r=function(e){var o=Ve(n.player)(e.value0)(e.value1)(n.state),a=At(n.color)(o);return{state:o,player:Pt(n.player),alive:!At(Pt(n.color))(o),winning:a,color:n.color,initDecision:n.initDecision}},t=iu(n.state);return t?_n(function(){var e=bn(n),o=kn(r);return function(a){return e(o(a))}}())(fu(n.state)):hn(n)},cu=function(n){return function(r){return n===0?hn(r):mn(cu(n-1|0))(mn(au)(St(vm)(r)))}},lu=function(n){return function(r){return function(){var e=_n(Nt)(mn(cr)(fr))(),o=ir("game--status")(e)(),a=kn(Tr)(o);if(a instanceof s)return void 0;if(a instanceof i)return Bn(r)(a.value0)(),nu(n)();throw new Error("Failed pattern match at Main (line 299, column 9 - line 303, column 29): "+[a.constructor.name])}}},_m=function(n){return lu(n)("It's a draw!")},gm=function(n){return function(r){return lu(n)(Ut(r)+" won!")}};var Dm=function(n){var r=em(Ht(function(t){return t.initDecision})(n));return kn(ba)(vt(om(ya)(r)))},bm=function(n){return function(r){return function(){var e=mn(cu(10))(mn(au)(dm(1e3)(r)(n)))(),o=Dm(e);if(o instanceof s)return r;if(o instanceof i)return Ve(n)(o.value0.value0)(o.value0.value1)(r);throw new Error("Failed pattern match at Main (line 134, column 16 - line 137, column 43): "+[o.constructor.name])}}},Qe=function(n){return function(r){return function(){nu(n)(),ur(Ut(r))();var e=mn(bm(r))(Ge(n))();return ur(im(e))(),je(n)(e)(),Je(n)()}}},ym=function(){var r=_n(Nt)(mn(cr)(fr))(),t=ir("game--status")(r)(),e=_n(Ue)(mn(cr)(fr))(),o=mn(xt)(Ft(".cell")(e))();je(o)(eu)();var a=kn(Tr)(t);if(a instanceof s)return void 0;if(a instanceof i){var p=ze(a.value0)();return Bn("You are playing "+Ut(p))(a.value0)(),function(){return p instanceof Z?void 0:Qe(o)(Z.value)()}(),Je(o)(),ur("Retarting game")()}throw new Error("Failed pattern match at Main (line 329, column 3 - line 339, column 30): "+[a.constructor.name])},hm=function(n){return ru(function(r){return ym})(n)},Tm=function(n){return function(r){return _n(At(r))(Ge(n))}},Ka=function(n){return function(r){return function(){var e=Tm(n)(r)();if(e)return Xa(gm(n)(r))(hn(e))();var o=_n(function(a){return!iu(a)})(Ge(n))();return Be(o)(_m(n))(),o}}},Cm=function(n){return function(r){return function(t){var e=ke(Se(t))(Oa);if(e instanceof s)return hn(void 0);if(e instanceof i)return function(){var a=ze(r)(),p=function(){var _=Mt(e.value0);if(_ instanceof i)return $a("active")(_.value0)();if(_ instanceof s)return s.value;throw new Error("Failed pattern match at Main (line 239, column 22 - line 241, column 49): "+[_.constructor.name])}(),d=Sr(e.value0)();return Be(am(p)(new i("true"))&&d==="")(function(){var _=function(){return a instanceof Z?"X":"O"}();return function(){Bn(_)(e.value0)();var T=Ka(n)(a)();return Be(!T)(Xa(function(){var A=Pt(a);return function(){return Qe(n)(A)(),Ka(n)(A)()}}())(hn(void 0)))()}}())()};throw new Error("Failed pattern match at Main (line 235, column 25 - line 254, column 29): "+[e.constructor.name])}}},Em=function(n){return function(r){return ru(Cm(n)(r))}};var Fm=function(n){return function(r){if(n instanceof s)return hn(void 0);if(r instanceof s)return hn(void 0);if(n instanceof i&&r instanceof i)return function(){var e=It(lm(n.value0))();return wt("change")(e)(!0)(za(r.value0))()};throw new Error("Failed pattern match at Main (line 198, column 1 - line 198, column 70): "+[n.constructor.name,r.constructor.name])}},Mm=function(){var r=_n(Nt)(mn(cr)(fr))(),t=_n(Ue)(mn(cr)(fr))(),e=ir("game--restart")(r)(),o=ir("game--label")(r)(),a=ir("game--selector")(r)(),p=ir("game--status")(r)();(function(){var T=kn(Tr)(e);if(T instanceof s)return void 0;if(T instanceof i)return hm(T.value0)();throw new Error("Failed pattern match at Main (line 350, column 3 - line 352, column 42): "+[T.constructor.name])})();var d=mn(xt)(Ft(".cell")(t))();je(d)(eu)(),Fm(kn(Tr)(o))(um(Qa)(a))();var _=kn(Tr)(p);if(_ instanceof s)return void 0;if(_ instanceof i){var S=ze(_.value0)();return Bn("You are playing "+Ut(S))(_.value0)(),function(){return S instanceof Z?void 0:Qe(d)(Z.value)()}(),Rt(Em(d)(_.value0))(d)(),Je(d)(),ur("Starting game")()}throw new Error("Failed pattern match at Main (line 358, column 3 - line 369, column 29): "+[_.constructor.name])},su=Mm;su();})();
